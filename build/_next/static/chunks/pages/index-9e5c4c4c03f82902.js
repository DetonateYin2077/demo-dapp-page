(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3020:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(9945)}])},9945:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r(8093),o=r(6945),i=r(9074);function a(){let[e,t]=(0,o.useState)(!1),[r,a]=(0,o.useState)(3);return(0,o.useEffect)(()=>{let e="true"===localStorage.getItem("isOpenOverridden");t(e),e&&(0,i.overrideWindowOpen)()},[]),(0,o.useEffect)(()=>{let e=setInterval(()=>{a(t=>t>1?t-1:(clearInterval(e),0))},1e3),t=setTimeout(()=>{window.open("https://t.me/BitgetWallet_TGBot/BGW","_blank")},3e3);return()=>{clearInterval(e),clearTimeout(t)}},[]),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Telegram SDK Example"}),(0,n.jsxs)("div",{children:["是否已重载",e]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{children:["倒计时: ",r," 秒"]}),0===r&&(0,n.jsx)("p",{children:"正在打开新页面..."})]}),(0,n.jsx)("button",{onClick:()=>window.open("https://t.me/BitgetWallet_TGBot/BGW"),children:"Open t.me Link"}),(0,n.jsx)("button",{onClick:()=>window.open("https://mini-app.bitkeep.com/"),children:"Open Normal Link"}),(0,n.jsx)("button",{onClick:()=>{e?localStorage.setItem("isOpenOverridden","false"):localStorage.setItem("isOpenOverridden","true"),t(!e)},children:e?"Restore window.open":"Override window.open"})]})}},9074:function(e,t){!function(e){"use strict";var t,r=Object.defineProperty,n=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,o=(e,t,r)=>(n(e,"symbol"!=typeof t?t+"":t,r),r);function i(e,t){let r;let n=()=>{void 0!==r&&t&&t(r),r=void 0};return[()=>void 0===r?r=e(n):r,n]}class a{constructor(e,t={}){this.scope=e,this.options=t}print(e,...t){let r=new Date,n=Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(r),{textColor:o,bgColor:i}=this.options,a="font-weight: bold;padding: 0 5px;border-radius:5px";console[e](`%c${n}%c / %c${this.scope}`,`${a};background-color: lightblue;color:black`,"",`${a};${o?`color:${o};`:""}${i?`background-color:${i}`:""}`,...t)}error(...e){this.print("error",...e)}log(...e){this.print("log",...e)}}let s=new a("SDK",{bgColor:"forestgreen",textColor:"white"});class p{constructor(){o(this,"listeners",new Map),o(this,"listenersCount",0),o(this,"subscribeListeners",[])}clear(){this.listeners.clear(),this.subscribeListeners=[]}get count(){return this.listenersCount+this.subscribeListeners.length}emit(e,...t){this.subscribeListeners.forEach(r=>r({event:e,args:t})),(this.listeners.get(e)||[]).forEach(([r,n])=>{r(...t),n&&this.off(e,r)})}on(e,t,r){let n=this.listeners.get(e);return n||this.listeners.set(e,n=[]),n.push([t,r]),this.listenersCount+=1,()=>this.off(e,t)}off(e,t){let r=this.listeners.get(e)||[];for(let e=0;e<r.length;e+=1)if(t===r[e][0]){r.splice(e,1),this.listenersCount-=1;return}}subscribe(e){return this.subscribeListeners.push(e),()=>this.unsubscribe(e)}unsubscribe(e){for(let t=0;t<this.subscribeListeners.length;t+=1)if(this.subscribeListeners[t]===e){this.subscribeListeners.splice(t,1);return}}}function l(e,t,r){return window.addEventListener(e,t,r),()=>window.removeEventListener(e,t,r)}function u(...e){let t=!1,r=e.flat(1);return[e=>!t&&r.push(e),()=>{t||(t=!0,r.forEach(e=>e()))},t]}class c extends Error{constructor(e,t,r){super(t,{cause:r}),this.type=e,Object.setPrototypeOf(this,c.prototype)}}function f(e,t,r){return new c(e,t,r)}let _="ERR_PARSE";function h(){return f("ERR_UNEXPECTED_TYPE","Value has unexpected type")}class d{constructor(e,t,r){this.parser=e,this.isOptional=t,this.type=r}parse(e){if(!(this.isOptional&&void 0===e))try{return this.parser(e)}catch(e){throw f(_,`Unable to parse value${this.type?` as ${this.type}`:""}`,e)}}optional(){return this.isOptional=!0,this}}function m(e,t){return()=>new d(e,!1,t)}let w=m(e=>{if("boolean"==typeof e)return e;let t=String(e);if("1"===t||"true"===t)return!0;if("0"===t||"false"===t)return!1;throw h()},"boolean");function b(e,t){let r={};for(let n in e){let o,i;let a=e[n];if(a){if("function"==typeof a||"parse"in a)o=n,i="function"==typeof a?a:a.parse.bind(a);else{let{type:e}=a;o=a.from||n,i="function"==typeof e?e:e.parse.bind(e)}try{let e=i(t(o));void 0!==e&&(r[n]=e)}catch(e){throw f(_,`Unable to parse field "${n}"`,e)}}}return r}function g(e){let t=e;if("string"==typeof t&&(t=JSON.parse(t)),"object"!=typeof t||null===t||Array.isArray(t))throw h();return t}function y(e,t){return new d(t=>{let r=g(t);return b(e,e=>r[e])},!1,t)}let v=m(e=>{if("number"==typeof e)return e;if("string"==typeof e){let t=Number(e);if(!Number.isNaN(t))return t}throw h()},"number"),E=m(e=>{if("string"==typeof e||"number"==typeof e)return e.toString();throw h()},"string");function T(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(e=>{delete window[e]})}function P(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}let x={clipboard_text_received:y({req_id:E(),data:e=>null===e?e:E().optional().parse(e)}),custom_method_invoked:y({req_id:E(),result:e=>e,error:E().optional()}),popup_closed:{parse:e=>y({button_id:e=>null==e?void 0:E().parse(e)}).parse(e??{})},viewport_changed:y({height:v(),width:e=>null==e?window.innerWidth:v().parse(e),is_state_stable:w(),is_expanded:w()})},[S,k]=i(e=>{let[t,r]=function(){let e=new p,t=new p;t.subscribe(t=>{e.emit("event",{name:t.event,payload:t.args[0]})}),[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{let t=window;e.forEach((e,r,n)=>{if(r===n.length-1){t[e]=P;return}e in t||(t[e]={}),t=t[e]})});let[,r]=u(T,l("resize",()=>{t.emit("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}),l("message",e=>{let r;if(e.source!==window.parent)return;try{var n;n=e.data,r=y({eventType:E(),eventData:e=>e}).parse(n)}catch{return}let{eventType:o,eventData:i}=r,a=x[o];try{let e=a?a.parse(i):i;t.emit(...e?[o,e]:[o])}catch(e){s.error(`An error occurred processing the "${o}" event from the Telegram application.
Please, file an issue here:
https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose`,r,e)}}),()=>e.clear(),()=>t.clear());return[{on:t.on.bind(t),off:t.off.bind(t),subscribe:t=>e.on("event",t),unsubscribe(t){e.off("event",t)},get count(){return t.count+e.count}},r]}(),n=t.off.bind(t);return t.off=(r,o)=>{let{count:i}=t;n(r,o),i&&!t.count&&e()},[t,r]},([,e])=>e());function O(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function A(e,t){return 0>=function(e,t){let r=e.split("."),n=t.split("."),o=Math.max(r.length,n.length);for(let e=0;e<o;e+=1){let t=parseInt(r[e]||"0",10),o=parseInt(n[e]||"0",10);if(t!==o)return t>o?1:-1}return 0}(e,t)}function R(e,t,r){if("string"==typeof r){if("web_app_open_link"===e){if("try_instant_view"===t)return A("6.4",r);if("try_browser"===t)return A("7.6",r)}if("web_app_set_header_color"===e&&"color"===t)return A("6.9",r);if("web_app_close"===e&&"return_back"===t)return A("7.6",r)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return A("6.1",t);case"web_app_open_popup":return A("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return A("6.4",t);case"web_app_switch_inline_query":return A("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return A("6.9",t);case"web_app_setup_settings_button":return A("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return A("7.2",t);case"web_app_setup_swipe_behavior":return A("7.7",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function W(e,t,r){var n,o;let i={},a;if(t||r?t&&r?(i=r,a=t):t&&("targetOrigin"in t?i=t:a=t):i={},function(){try{return window.self!==window.top}catch{return!0}}())return window.parent.postMessage(JSON.stringify({eventType:e,eventData:a}),i.targetOrigin||"https://web.telegram.org");if("external"in(n=window)&&O(n.external)&&"notify"in n.external&&"function"==typeof n.external.notify){window.external.notify(JSON.stringify({eventType:e,eventData:a}));return}if("TelegramWebviewProxy"in(o=window)&&O(o.TelegramWebviewProxy)&&"postEvent"in o.TelegramWebviewProxy&&"function"==typeof o.TelegramWebviewProxy.postEvent){window.TelegramWebviewProxy.postEvent(e,JSON.stringify(a));return}throw f("ERR_UNKNOWN_ENV","Unable to determine current environment and possible way to send event. You are probably trying to use Mini Apps method outside the Telegram application environment.")}async function $(e){let t;let r=new Promise(e=>t=e),{event:n,capture:o,timeout:i}=e,[,a]=u((Array.isArray(n)?n:[n]).map(e=>{var r;return r=r=>{(!o||(Array.isArray(n)?o({event:e,payload:r}):o(r)))&&t(r)},S()[0].on(e,r,void 0)}));try{return(e.postEvent||W)(e.method,e.params),await (i?Promise.race(["function"==typeof r?r():r,new Promise((e,t)=>{setTimeout(()=>{t(f("ERR_TIMED_OUT",`Timeout reached: ${i}ms`))},i)})]):r)}finally{a()}}let L=m(e=>e instanceof Date?e:new Date(1e3*v().parse(e)),"Date");function D(e,t){return new d(t=>{if("string"!=typeof t&&!(t instanceof URLSearchParams))throw h();let r="string"==typeof t?new URLSearchParams(t):t;return b(e,e=>{let t=r.get(e);return null===t?void 0:t})},!1,t)}let N=y({id:v(),type:E(),title:E(),photoUrl:{type:E().optional(),from:"photo_url"},username:E().optional()},"Chat").optional(),I=y({addedToAttachmentMenu:{type:w().optional(),from:"added_to_attachment_menu"},allowsWriteToPm:{type:w().optional(),from:"allows_write_to_pm"},firstName:{type:E(),from:"first_name"},id:v(),isBot:{type:w().optional(),from:"is_bot"},isPremium:{type:w().optional(),from:"is_premium"},languageCode:{type:E().optional(),from:"language_code"},lastName:{type:E().optional(),from:"last_name"},photoUrl:{type:E().optional(),from:"photo_url"},username:E().optional()},"User").optional(),C=m(e=>(function(e){let t=e.replace(/\s/g,"").toLowerCase();if(/^#[\da-f]{6}$/i.test(t))return t;if(/^#[\da-f]{3}$/i.test(t)){let e="#";for(let r=0;r<3;r+=1)e+=t[1+r].repeat(2);return e}let r=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw Error(`Value "${e}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((e,t)=>{let r=parseInt(t,10).toString(16);return e+(1===r.length?"0":"")+r},"#")})(E().parse(e)),"rgb"),U=m(e=>{let t=C().optional();return Object.entries(g(e)).reduce((e,[r,n])=>(e[r.replace(/_[a-z]/g,e=>e[1].toUpperCase())]=t.parse(n),e),{})},"ThemeParams");function q(e){return D({botInline:{type:w().optional(),from:"tgWebAppBotInline"},initData:{type:D({authDate:{type:L(),from:"auth_date"},canSendAfter:{type:v().optional(),from:"can_send_after"},chat:N,chatInstance:{type:E().optional(),from:"chat_instance"},chatType:{type:E().optional(),from:"chat_type"},hash:E(),queryId:{type:E().optional(),from:"query_id"},receiver:I,startParam:{type:E().optional(),from:"start_param"},user:I},"InitData").optional(),from:"tgWebAppData"},initDataRaw:{type:E().optional(),from:"tgWebAppData"},platform:{type:E(),from:"tgWebAppPlatform"},showSettings:{type:w().optional(),from:"tgWebAppShowSettings"},startParam:{type:E().optional(),from:"tgWebAppStartParam"},themeParams:{type:U(),from:"tgWebAppThemeParams"},version:{type:E(),from:"tgWebAppVersion"}}).parse(e)}function j(e){return q(e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function M(){return j(window.location.href)}function B(){return performance.getEntriesByType("navigation")[0]}function G(){let e=B();if(!e)throw Error("Unable to get first navigation entry.");return j(e.name)}function J(e){return`telegram-apps/${e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}`}function V(e,t){sessionStorage.setItem(J(e),JSON.stringify(t))}function F(e){let t=sessionStorage.getItem(J(e));try{return t?JSON.parse(t):void 0}catch{}}function H(){return q(F("launchParams")||"")}let[K]=i(function(){let e=0;return()=>(e+=1).toString()});class X{constructor(e,t){o(this,"supports"),this.supports=r=>R(t[r],e)}}function Z(e,t){return e.startsWith(t)?e:`${t}${e}`}class z extends X{constructor(e,t,r){var n;super(e,{readTextFromClipboard:"web_app_read_text_from_clipboard"}),o(this,"supportsParam"),this.version=e,this.createRequestId=t,this.postEvent=r,this.supportsParam=(n={"openLink.tryInstantView":["web_app_open_link","try_instant_view"]},t=>{let[r,o]=n[t];return R(r,o,e)})}openLink(e,t){let r=new URL("string"==typeof e?e:`${e.pathname||""}${Z(e.search||"","?")}${Z(e.hash||"","#")}`,"http://a").toString();if(!R("web_app_open_link",this.version)){window.open(r,"_blank");return}let n="boolean"==typeof t?{tryInstantView:t}:t||{};this.postEvent("web_app_open_link",{url:r,try_browser:n.tryBrowser,try_instant_view:n.tryInstantView})}openTelegramLink(e){let{hostname:t,pathname:r,search:n}=new URL(e,"https://t.me");if("t.me"!==t)throw Error(`URL has not allowed hostname: ${t}. Only "t.me" is allowed`);if(!R("web_app_open_tg_link",this.version)){window.location.href=e;return}this.postEvent("web_app_open_tg_link",{path_full:r+n})}async readTextFromClipboard(){let e=this.createRequestId(),{data:t=null}=await $({method:"web_app_read_text_from_clipboard",event:"clipboard_text_received",postEvent:this.postEvent,params:{req_id:e},capture:({req_id:t})=>t===e});return t}shareURL(e,t){this.openTelegramLink("https://t.me/share/url?"+new URLSearchParams({url:e,text:t||""}).toString().replace(/\+/g,"%20"))}}let Y=(t=({version:e,postEvent:t,createRequestId:r})=>new z(e,r,t),()=>{var e;let r=function(){let e=[];for(let t of[M,G,H])try{let e=t();return V("launchParams",function(e){let{initDataRaw:t,themeParams:r,platform:n,version:o,showSettings:i,startParam:a,botInline:s}=e,p=new URLSearchParams;return p.set("tgWebAppPlatform",n),p.set("tgWebAppThemeParams",JSON.stringify(Object.fromEntries(Object.entries(r).map(([e,t])=>[e.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`),t])))),p.set("tgWebAppVersion",o),t&&p.set("tgWebAppData",t),a&&p.set("tgWebAppStartParam",a),"boolean"==typeof i&&p.set("tgWebAppShowSettings",i?"1":"0"),"boolean"==typeof s&&p.set("tgWebAppBotInline",s?"1":"0"),p.toString()}(e)),e}catch(t){e.push(t instanceof Error?t.message:JSON.stringify(t))}throw Error([`Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?
`,"\uD83D\uDCD6 Refer to docs for more information:",`https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/environment
`,"Collected errors:",e.map(e=>`— ${e}`)].join(`
`))}(),n={...r,postEvent:(e=r.version,(t,r)=>{if(!R(t,e))throw f("ERR_METHOD_UNSUPPORTED",`Method "${t}" is unsupported in Mini Apps version ${e}`);if(O(r)&&"web_app_set_header_color"===t&&"color"in r&&!R(t,"color",e))throw f("ERR_METHOD_PARAMETER_UNSUPPORTED",`Parameter "color" of "${t}" method is unsupported in Mini Apps version ${e}`);return W(t,r)}),createRequestId:K()};if("function"==typeof t)return t(n);let[o,i,a]=u(),s=(void 0)({...n,state:!function(){let e=B();return!!(e&&"reload"===e.type)}()?void 0:F(t),addCleanup:o}),p=e=>(a||o(e.on("change",e=>{V(t,e)})),e);return[s instanceof Promise?s.then(p):p(s),i]});function Q(){var e,t;return"undefined"!=typeof window&&"Telegram"in window&&(null===(t=null===(e=window.Telegram)||void 0===e?void 0:e.Webapp)||void 0===t?void 0:t.initData)}e.isTelegramEnvironment=Q,e.overrideWindowOpen=function(){let e=Y(),t=window.open;window.open=(r,...n)=>{if(!Q())return t(r,...n);try{r.startsWith("tg://")||r.includes("t.me")?e.openTelegramLink(r):e.openLink(r)}catch(e){console.error("open with tg methods failed",e)}return null}}}(t)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=3020)}),_N_E=e.O()}]);